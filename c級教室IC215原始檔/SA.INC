SA_START:
setb sa_sda
NOP
NOP
SETB SA_SCL
NOP
NOP
CLR SA_SDA
NOP
NOP
CLR SA_SCL
RET
SA_STOP:
CLR SA_SDA
NOP
NOP
SETB SA_SCL
NOP
NOP
SETB SA_SDA
NOP
NOP
CLR     SA_SCL
RET
ACK:
CLR SA_SDA
NOP ;; you
SETB SA_SCL
NOP
NOP
CLR SA_SCL
RET
NACK:
SETB SA_SCL
NOP
NOP
CLR SA_SCL
RET
;;---------------------------
B_W:CALL SA_START
    MOV  A,#0A0H
    CALL SEND
    NOP
    nop
    nop
    CALL ACK
    NOP
    NOP
    NOP
    MOV A,SA_ADD
    CALL SEND
    nop
    NOP
    NOP
    CALL ACK
    MOV A,SA_DATA
    CALL SEND
    nop
    NOP
    NOP
    CALL ACK
    nop
    NOP
    NOP
    CALL SA_STOP
   ; call sa_stop
RET
B_WP:
DEC R1   ;;   DATA ADDRS
CALL SA_START
MOV  A,#0A0H
CALL SEND
NOP
CALL ACK
NOP
MOV A,#00H
CALL      SEND
NOP
CALL    ACK
MOV R3,#7
WP_1:INC R1
MOV A,@R1   ;;;;;DATA
CALL SEND
NOP
CALL ACK    ;;;;;;;;;
DJNZ R3,WP_1
CALL SA_STOP
RET
B_WW:
CALL   SA_START
MOV    A,#0A0H
CALL   SEND
NOP
CALL   ACK
NOP
MOV    A,SA_ADD
CALL   SEND
NOP
CALL    ACK
MOV     A,SA_DATA
CALL    SEND
NOP
CALL    ACK
NOP
CALL    SA_STOP
RET
;--------------------------------
B_R:
CALL SA_START
MOV  A,#0A0H
CALL SEND
nop
CALL ACK
MOV  A,SA_ADD
CALL SEND
NOP
CALL ACK
CALL SA_START
MOV  A,#0A1H
CALL SEND
CALL ACK
CALL SHOU
MOV SA_DATA,A
;CALL NACK
NOP
nop
CALL SA_STOP
RET
;-------------------


SEND:
CLR SA_SCL
MOV 02H,#8
SEND_LOOP:JB ACC.7,SG
SD:CLR SA_SDA
   JMP NSG
SG:SETB SA_SDA
NSG:SETB SA_SCL
    DJNZ 02H,SEND_JX
    CLR SA_SCL
RET
SEND_JX:
CLR SA_SCL
RL A
JMP SEND_LOOP
SHOU:
MOV   A,#00H
MOV   R4,#08H
SETB  SA_SDA
LOOPREAD:
SETB     SA_SCL
JB       SA_SDA,GAOGAO
CLR      C
JMP      HA
GAOGAO:SETB C
HA:RLC  A
CLR   SA_SCL
DJNZ     R4,LOOPREAD
CLR      SA_SCL
RET



